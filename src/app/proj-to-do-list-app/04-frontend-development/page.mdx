import BackToTop from "@/components/BackToTop";

# Frontend Development

## Introduction

In this module, we'll develop the frontend of our To-Do List application using Next.js, TypeScript, and Tailwind CSS. We'll create components to display and manage tasks, handle user authentication, and interact with our backend API.

## Setting Up Frontend Structure

Let's organize our frontend code with a clear structure:

```txt title="Project Structure"
src/
├── app/                   # Next.js app router
│   ├── page.tsx           # Home page
│   ├── layout.tsx         # Root layout
│   ├── auth/              # Authentication pages
│   │   ├── login/         # Login page
│   │   └── register/      # Registration page
│   ├── dashboard/         # User dashboard
│   │   └── page.tsx       # Dashboard page
│   └── tasks/             # Task management
│       ├── page.tsx       # Tasks list page
│       ├── [id]/          # Task detail page
│       └── new/           # New task page
├── components/            # Reusable components
│   ├── auth/              # Auth-related components
│   ├── layout/            # Layout components
│   ├── tasks/             # Task-related components
│   └── ui/                # UI components
└── lib/                   # Utility functions
    ├── api.ts             # API client
    └── auth.ts            # Auth utilities
```

<BackToTop />

## Creating Layout and Navigation

First, let's create our base layout and navigation.

### Root Layout

Update `src/app/layout.tsx`:

```tsx title="src/app/layout.tsx"
import "./globals.css";
import type { Metadata } from "next";
import { Inter } from "next/font/google";
import Header from "@/components/layout/Header";
import Footer from "@/components/layout/Footer";
import { AuthProvider } from "@/components/auth/AuthProvider";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Todo App",
  description: "A full-stack Todo application",
};

export default function RootLayout({
  children,
}: {
  children: React.ReactNode;
}) {
  return (
    <html lang="en">
      <body className={inter.className}>
        <AuthProvider>
          <div className="min-h-screen flex flex-col">
            <Header />
            <main className="flex-grow container mx-auto px-4 py-8">
              {children}
            </main>
            <Footer />
          </div>
        </AuthProvider>
      </body>
    </html>
  );
}
```

<BackToTop />

### Header Component

Create `src/components/layout/Header.tsx`:

```tsx title="src/components/layout/Header.tsx"
"use client";

import Link from "next/link";
import { useRouter } from "next/navigation";
import { useAuth } from "@/components/auth/AuthProvider";

export default function Header() {
  const { user, logout } = useAuth();
  const router = useRouter();

  const handleLogout = () => {
    logout();
    router.push("/");
  };

  return (
    <header className="bg-blue-600 text-white shadow-md">
      <div className="container mx-auto px-4 py-4 flex justify-between items-center">
        <Link href="/" className="text-2xl font-bold">
          Todo App
        </Link>

        <nav>
          <ul className="flex space-x-6">
            <li>
              <Link href="/" className="hover:text-blue-200">
                Home
              </Link>
            </li>

            {user ? (
              <>
                <li>
                  <Link href="/dashboard" className="hover:text-blue-200">
                    Dashboard
                  </Link>
                </li>
                <li>
                  <Link href="/tasks" className="hover:text-blue-200">
                    Tasks
                  </Link>
                </li>
                <li>
                  <button
                    onClick={handleLogout}
                    className="hover:text-blue-200"
                  >
                    Logout
                  </button>
                </li>
              </>
            ) : (
              <>
                <li>
                  <Link href="/auth/login" className="hover:text-blue-200">
                    Login
                  </Link>
                </li>
                <li>
                  <Link href="/auth/register" className="hover:text-blue-200">
                    Register
                  </Link>
                </li>
              </>
            )}
          </ul>
        </nav>
      </div>
    </header>
  );
}
```

### Footer Component

Create `src/components/layout/Footer.tsx`:

```tsx title="src/components/layout/Footer.tsx"
export default function Footer() {
  return (
    <footer className="bg-gray-800 text-white py-6">
      <div className="container mx-auto px-4 text-center">
        <p>© {new Date().getFullYear()} Todo App. All rights reserved.</p>
      </div>
    </footer>
  );
}
```

<BackToTop />

## Creating Authentication Components

### AuthProvider

Create `src/components/auth/AuthProvider.tsx`:

```tsx title="src/components/auth/AuthProvider.tsx"
"use client";

import {
  createContext,
  useContext,
  useState,
  useEffect,
  ReactNode,
} from "react";
import { useRouter } from "next/navigation";
import { login as apiLogin, register as apiRegister } from "@/lib/api";

interface User {
  id: number;
  username: string;
  email: string;
}

interface AuthContextType {
  user: User | null;
  token: string | null;
  loading: boolean;
  login: (username: string, password: string) => Promise<void>;
  register: (
    username: string,
    email: string,
    password: string
  ) => Promise<void>;
  logout: () => void;
}

const AuthContext = createContext<AuthContextType | undefined>(undefined);

export function AuthProvider({ children }: { children: ReactNode }) {
  const [user, setUser] = useState<User | null>(null);
  const [token, setToken] = useState<string | null>(null);
  const [loading, setLoading] = useState(true);
  const router = useRouter();

  // Load user from localStorage on initial load
  useEffect(() => {
    const storedUser = localStorage.getItem("user");
    const storedToken = localStorage.getItem("token");

    if (storedUser && storedToken) {
      setUser(JSON.parse(storedUser));
      setToken(storedToken);
    }

    setLoading(false);
  }, []);

  // Login function
  const login = async (username: string, password: string) => {
    try {
      setLoading(true);
      const { user, token } = await apiLogin(username, password);

      // Save to state
      setUser(user);
      setToken(token);

      // Save to localStorage
      localStorage.setItem("user", JSON.stringify(user));
      localStorage.setItem("token", token);

      router.push("/dashboard");
    } catch (error) {
      console.error("Login error:", error);
      throw error;
    } finally {
      setLoading(false);
    }
  };

  // Register function
  const register = async (
    username: string,
    email: string,
    password: string
  ) => {
    try {
      setLoading(true);
      const { user, token } = await apiRegister(username, email, password);

      // Save to state
      setUser(user);
      setToken(token);

      // Save to localStorage
      localStorage.setItem("user", JSON.stringify(user));
      localStorage.setItem("token", token);

      router.push("/dashboard");
    } catch (error) {
      console.error("Registration error:", error);
      throw error;
    } finally {
      setLoading(false);
    }
  };

  // Logout function
  const logout = () => {
    // Clear state
    setUser(null);
    setToken(null);

    // Clear localStorage
    localStorage.removeItem("user");
    localStorage.removeItem("token");

    router.push("/");
  };

  return (
    <AuthContext.Provider
      value={{ user, token, loading, login, register, logout }}
    >
      {children}
    </AuthContext.Provider>
  );
}

export function useAuth() {
  const context = useContext(AuthContext);
  if (context === undefined) {
    throw new Error("useAuth must be used within an AuthProvider");
  }
  return context;
}
```

<BackToTop />

### Login Page

Create `src/app/auth/login/page.tsx`:

```tsx title="src/app/auth/login/page.tsx"
"use client";

import { useState } from "react";
import { useAuth } from "@/components/auth/AuthProvider";
import Link from "next/link";

export default function LoginPage() {
  const { login, loading } = useAuth();
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [error, setError] = useState("");

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError("");

    try {
      await login(username, password);
    } catch (err: any) {
      setError(
        err.message || "Failed to login. Please check your credentials."
      );
    }
  };

  return (
    <div className="max-w-md mx-auto">
      <h1 className="text-3xl font-bold mb-6 text-center">Login</h1>

      {error && (
        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          {error}
        </div>
      )}

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label
            htmlFor="username"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Username
          </label>
          <input
            id="username"
            type="text"
            value={username}
            onChange={(e) => setUsername(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <label
            htmlFor="password"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Password
          </label>
          <input
            id="password"
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <button
            type="submit"
            disabled={loading}
            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"
          >
            {loading ? "Logging in..." : "Login"}
          </button>
        </div>
      </form>

      <div className="mt-6 text-center">
        <p className="text-sm text-gray-600">
          Don't have an account?{" "}
          <Link
            href="/auth/register"
            className="text-blue-600 hover:text-blue-500"
          >
            Register here
          </Link>
        </p>
      </div>
    </div>
  );
}
```

<BackToTop />

### Register Page

Create `src/app/auth/register/page.tsx`:

```tsx title="src/app/auth/register/page.tsx"
"use client";

import { useState } from "react";
import { useAuth } from "@/components/auth/AuthProvider";
import Link from "next/link";

export default function RegisterPage() {
  const { register, loading } = useAuth();
  const [username, setUsername] = useState("");
  const [email, setEmail] = useState("");
  const [password, setPassword] = useState("");
  const [confirmPassword, setConfirmPassword] = useState("");
  const [error, setError] = useState("");

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    setError("");

    if (password !== confirmPassword) {
      setError("Passwords do not match");
      return;
    }

    try {
      await register(username, email, password);
    } catch (err: any) {
      setError(err.message || "Failed to register. Please try again.");
    }
  };

  return (
    <div className="max-w-md mx-auto">
      <h1 className="text-3xl font-bold mb-6 text-center">Register</h1>

      {error && (
        <div className="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4">
          {error}
        </div>
      )}

      <form onSubmit={handleSubmit} className="space-y-4">
        <div>
          <label
            htmlFor="username"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Username
          </label>
          <input
            id="username"
            type="text"
            value={username}
            onChange={(e) => setUsername(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <label
            htmlFor="email"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Email
          </label>
          <input
            id="email"
            type="email"
            value={email}
            onChange={(e) => setEmail(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <label
            htmlFor="password"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Password
          </label>
          <input
            id="password"
            type="password"
            value={password}
            onChange={(e) => setPassword(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <label
            htmlFor="confirmPassword"
            className="block text-sm font-medium text-gray-700 mb-1"
          >
            Confirm Password
          </label>
          <input
            id="confirmPassword"
            type="password"
            value={confirmPassword}
            onChange={(e) => setConfirmPassword(e.target.value)}
            required
            className="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"
          />
        </div>

        <div>
          <button
            type="submit"
            disabled={loading}
            className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50"
          >
            {loading ? "Registering..." : "Register"}
          </button>
        </div>
      </form>

      <div className="mt-6 text-center">
        <p className="text-sm text-gray-600">
          Already have an account?{" "}
          <Link
            href="/auth/login"
            className="text-blue-600 hover:text-blue-500"
          >
            Login here
          </Link>
        </p>
      </div>
    </div>
  );
}
```

<BackToTop />

## Creating Task Components

### Task Interface

Create `src/lib/types.ts`:

```typescript title="src/lib/types.ts"
export interface Task {
  id: number;
  title: string;
  description?: string;
  dueDate?: string;
  completed: boolean;
  userId: number;
  createdAt: string;
  updatedAt: string;
}

export interface User {
  id: number;
  username: string;
  email: string;
}
```

### Task List Component

Create `src/components/tasks/TaskList.tsx`:

```tsx title="src/components/tasks/TaskList.tsx"
"use client";

import { useState } from "react";
import Link from "next/link";
import { Task } from "@/lib/types";
import TaskItem from "./TaskItem";
import { completeTask, deleteTask } from "@/lib/api";

interface TaskListProps {
  initialTasks: Task[];
}

export default function TaskList({ initialTasks }: TaskListProps) {
  const [tasks, setTasks] = useState<Task[]>(initialTasks);
  const [filter, setFilter] = useState<"all" | "active" | "completed">("all");

  const handleToggleComplete = async (taskId: number) => {
    try {
      const updatedTask = await completeTask(taskId);
      setTasks(tasks.map((task) => (task.id === taskId ? updatedTask : task)));
    } catch (error) {
      console.error("Error toggling task completion:", error);
    }
  };

  const handleDelete = async (taskId: number) => {
    try {
      await deleteTask(taskId);
      setTasks(tasks.filter((task) => task.id !== taskId));
    } catch (error) {
      console.error("Error deleting task:", error);
    }
  };

  const filteredTasks = tasks.filter((task) => {
    if (filter === "all") return true;
    if (filter === "active") return !task.completed;
    if (filter === "completed") return task.completed;
    return true;
  });

  return (
    <div>
      <div className="flex justify-between items-center mb-6">
        <h2 className="text-2xl font-bold">Your Tasks</h2>
        <Link
          href="/tasks/new"
          className="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition"
        >
          Add New Task
        </Link>
      </div>

      <div className="mb-6">
        <div className="flex space-x-4 border-b">
          <button
            className={`px-4 py-2 ${filter === "all" ? "border-b-2 border-blue-500 font-medium" : ""}`}
            onClick={() => setFilter("all")}
          >
            All
          </button>
          <button
            className={`px-4 py-2 ${filter === "active" ? "border-b-2 border-blue-500 font-medium" : ""}`}
            onClick={() => setFilter("active")}
          >
            Active
          </button>
          <button
            className={`px-4 py-2 ${filter === "completed" ? "border-b-2 border-blue-500 font-medium" : ""}`}
            onClick={() => setFilter("completed")}
          >
            Completed
          </button>
        </div>
      </div>

      {filteredTasks.length === 0 ? (
        <div className="text-center py-8 text-gray-500">
          No tasks found. {filter !== "all" && "Try changing your filter or "}
          <Link href="/tasks/new" className="text-blue-500 hover:underline">
            add a new task
          </Link>
          .
        </div>
      ) : (
        <ul className="space-y-3">
          {filteredTasks.map((task) => (
            <TaskItem
              key={task.id}
              task={task}
              onToggleComplete={handleToggleComplete}
              onDelete={handleDelete}
            />
          ))}
        </ul>
      )}
    </div>
  );
}
```

<BackToTop />

### Task Item Component

Create `src/components/tasks/TaskItem.tsx`:

```tsx title="src/components/tasks/TaskItem.tsx"
import Link from "next/link";
import { Task } from "@/lib/types";
import { formatDate } from "@/lib/utils";

interface TaskItemProps {
  task: Task;
  onToggleComplete: (id: number) => void;
  onDelete: (id: number) => void;
}

export default function TaskItem({
  task,
  onToggleComplete,
  onDelete,
}: TaskItemProps) {
  return (
    <li className="border rounded-lg p-4 bg-white shadow-sm hover:shadow-md transition">
      <div className="flex items-start justify-between">
        <div className="flex items-start space-x-3">
          <input
            type="checkbox"
            checked={task.completed}
            onChange={() => onToggleComplete(task.id)}
            className="mt-1 h-5 w-5 rounded border-gray-300 text-blue-600 focus:ring-blue-500"
          />

          <div>
            <Link href={`/tasks/${task.id}`}>
              <h3
                className={`text-lg font-medium ${task.completed ? "line-through text-gray-500" : ""}`}
              >
                {task.title}
              </h3>
            </Link>

            {task.description && (
              <p
                className={`mt-1 text-gray-600 ${task.completed ? "text-gray-400" : ""}`}
              >
                {task.description.length > 100
                  ? `${task.description.substring(0, 100)}...`
                  : task.description}
              </p>
            )}

            {task.dueDate && (
              <p className="mt-2 text-sm text-gray-500">
                Due: {formatDate(task.dueDate)}
              </p>
            )}
          </div>
        </div>

        <div className="flex space-x-2">
          <Link
            href={`/tasks/${task.id}/edit`}
            className="text-blue-600 hover:text-blue-800"
          >
            Edit
          </Link>

          <button
            onClick={() => onDelete(task.id)}
            className="text-red-600 hover:text-red-800"
          >
            Delete
          </button>
        </div>
      </div>
    </li>
  );
}
```

<BackToTop />

### API Client

Create `src/lib/api.ts`:

```typescript title="src/lib/api.ts"
import { Task, User } from "./types";

const API_URL = process.env.NEXT_PUBLIC_API_URL || "http://localhost:3001/api";

// Helper function to get the auth token
const getToken = (): string | null => {
  if (typeof window !== "undefined") {
    return localStorage.getItem("token");
  }
  return null;
};

// Helper function for API requests
async function fetchWithAuth(endpoint: string, options: RequestInit = {}) {
  const token = getToken();

  const headers = {
    "Content-Type": "application/json",
    ...(token ? { Authorization: `Bearer ${token}` } : {}),
    ...options.headers,
  };

  const response = await fetch(`${API_URL}${endpoint}`, {
    ...options,
    headers,
  });

  const data = await response.json();

  if (!response.ok) {
    throw new Error(data.message || "Something went wrong");
  }

  return data;
}

// Authentication APIs
export async function login(username: string, password: string) {
  return fetchWithAuth("/auth/login", {
    method: "POST",
    body: JSON.stringify({ username, password }),
  });
}

export async function register(
  username: string,
  email: string,
  password: string
) {
  return fetchWithAuth("/auth/register", {
    method: "POST",
    body: JSON.stringify({ username, email, password }),
  });
}

// Task APIs
export async function getTasks(): Promise<Task[]> {
  return fetchWithAuth("/tasks");
}

export async function getTask(id: number): Promise<Task> {
  return fetchWithAuth(`/tasks/${id}`);
}

export async function createTask(taskData: Partial<Task>): Promise<Task> {
  return fetchWithAuth("/tasks", {
    method: "POST",
    body: JSON.stringify(taskData),
  });
}

export async function updateTask(
  id: number,
  taskData: Partial<Task>
): Promise<Task> {
  return fetchWithAuth(`/tasks/${id}`, {
    method: "PUT",
    body: JSON.stringify(taskData),
  });
}

export async function completeTask(id: number): Promise<Task> {
  return fetchWithAuth(`/tasks/${id}/complete`, {
    method: "PATCH",
  });
}

export async function deleteTask(id: number): Promise<void> {
  return fetchWithAuth(`/tasks/${id}`, {
    method: "DELETE",
  });
}

// User APIs
export async function getUserProfile(): Promise<User> {
  return fetchWithAuth("/users/profile");
}

export async function updateUserProfile(
  userData: Partial<User>
): Promise<User> {
  return fetchWithAuth("/users/profile", {
    method: "PUT",
    body: JSON.stringify(userData),
  });
}
```

### Utility Functions

Create `src/lib/utils.ts`:

```typescript title="src/lib/utils.ts"
export function formatDate(dateString: string): string {
  const date = new Date(dateString);
  return date.toLocaleDateString("en-US", {
    year: "numeric",
    month: "short",
    day: "numeric",
  });
}

export function classNames(
  ...classes: (string | boolean | undefined)[]
): string {
  return classes.filter(Boolean).join(" ");
}
```

## Next Steps

In this module, we've built the foundation of our frontend application using Next.js, TypeScript, and Tailwind CSS. We've created components for user authentication and task management, and implemented an API client to interact with our backend.

In the next module, we'll implement Passport.js for authentication with bcrypt for password hashing.

[Next: Authentication with Passport.js →](/proj-to-do-list-app/05-authentication)

<BackToTop />
